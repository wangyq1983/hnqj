(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/info/info"],{"004d":function(e,t,i){"use strict";i.r(t);var n=i("d6ef"),o=i.n(n);for(var a in n)"default"!==a&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=o.a},"199a":function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n}));var n={helangCompress:function(){return i.e("components/helang-compress/helang-compress").then(i.bind(null,"66a8"))}},o=function(){var e=this,t=e.$createElement;e._self._c},a=[]},"4a7d":function(e,t,i){"use strict";var n=i("dd61"),o=i.n(n);o.a},a95b:function(e,t,i){"use strict";i.r(t);var n=i("199a"),o=i("004d");for(var a in o)"default"!==a&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("4a7d");var s,r=i("f0c5"),c=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],s);t["default"]=c.exports},b2e4:function(e,t,i){"use strict";(function(e){i("b752");n(i("66fd"));var t=n(i("a95b"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("543d")["createPage"])},d6ef:function(e,t,i){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(i("a34a"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t,i,n,o,a,s){try{var r=e[a](s),c=r.value}catch(l){return void i(l)}r.done?t(c):Promise.resolve(c).then(n,o)}function r(e){return function(){var t=this,i=arguments;return new Promise((function(n,o){var a=e.apply(t,i);function r(e){s(a,n,o,r,c,"next",e)}function c(e){s(a,n,o,r,c,"throw",e)}r(void 0)}))}}var c=function(){i.e("components/helang-compress/helang-compress").then(function(){return resolve(i("66a8"))}.bind(null,i)).catch(i.oe)},l={components:{helangCompress:c},data:function(){var e=this.getDate({format:!0});return{id:null,number:"",isEdit:!1,sex:"",itemsSex:[{value:"1",name:"男",checked:!1},{value:"2",name:"女",checked:!1}],edu:"",itemsEdu:[{value:"博士",name:"博士",checked:!1},{value:"硕士",name:"硕士",checked:!1},{value:"本科",name:"本科",checked:!1},{value:"专科",name:"专科",checked:!1},{value:"高中或职专",name:"高中或职专",checked:!1},{value:"初中及以下",name:"初中及以下",checked:!1}],itemsHouse:[{value:"0",name:"无房",checked:!1},{value:"1",name:"有房无贷款",checked:!1},{value:"2",name:"有房有贷款",checked:!1}],itemsCar:[{value:"0",name:"无车",checked:!1},{value:"1",name:"有车",checked:!1}],itemsOnlyChild:[{value:"1",name:"是独生子女",checked:!1},{value:"2",name:"非独生子女",checked:!1}],itemsMarriage:[{value:"0",name:"未婚",checked:!1},{value:"1",name:"离异无孩子",checked:!1},{value:"2",name:"离异有孩子",checked:!1}],itemsPhotoPublic:[{value:"0",name:"不公开",checked:!1},{value:"1",name:"公开",checked:!1}],date:e,shengao:"",tizhong:"",sxxz:"",job:"",income:"",house:"",houseTxt:"",car:"",carTxt:"",hometown:"",workArea:"",parentsInfo:"",onlyChild:"",family:"",marriage:"",marriageTxt:"",introduction:"",requirement:"",photoPublic:"",state:0,infoLock:0,imglist:[],compressPaths:[],paths:[],curindex:0,filelist:[]}},computed:{startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate("end")}},onLoad:function(e){this.init()},methods:{init:function(){var e=this;return r(o.default.mark((function t(){var i,n,a,s,r,c;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.showLoading();case 2:return t.next=4,e.$api.getData(e.$api.webapi.memberInfo);case 4:return i=t.sent,t.next=7,e.$api.hideLoading();case 7:if(0==i.resultCode)if(n=Object.keys(i.data),console.log("searchRes.data"),console.log(i.data),console.log(n),console.log(n.length),0==n.length)e.isEdit=!1;else{for(e.isEdit=!0,a=i.data,e.id=a.id,e.number=a.number,e.sex=a.gender,e.edu=a.education,e.house=a.house,e.car=a.car,e.onlyChild=a.onlyChild,e.marriage=a.marriage,e.photoPublic=a.photoPublic,s=[e.sex,e.edu,e.house,e.car,e.onlyChild,e.marriage,e.photoPublic],r=[e.itemsSex,e.itemsEdu,e.itemsHouse,e.itemsCar,e.itemsOnlyChild,e.itemsMarriage,e.itemsPhotoPublic],c=0;c<s.length;c++)e.initItem(r[c],s[c]);e.date=a.birthYear+"-"+(a.birthMonth?a.birthMonth:""),e.shengao=a.height,e.tizhong=a.bodyWeight,e.sxxz=a.zodiacConstellation,e.job=a.job,e.income=a.income,e.houseTxt=a.houseTxt,e.carTxt=a.carTxt,e.hometown=a.hometown,e.workArea=a.workArea,e.parentsInfo=a.parentsInfo,e.family=a.family,e.marriageTxt=a.marriageTxt,e.introduction=a.introduction,e.requirement=a.requirement,e.state=a.state,e.infoLock=a.infoLock,e.imglist=JSON.parse(a.imageList)}case 8:case"end":return t.stop()}}),t)})))()},delimg:function(e){var t=e.target.dataset.fileid;console.log(e),console.log(e.target.dataset.fileid),console.log(this.imglist),this.imglist=this.imglist.filter((function(e){return e!==t})),console.log(this.imglist)},radioChangeSex:function(e){for(var t=0;t<this.itemsSex.length;t++)if(this.itemsSex[t].value===e.target.value){this.current=t,this.sex=e.target.value;break}},initItem:function(e,t){for(var i=0;i<e.length;i++)if(e[i].value===String(t)){e[i].checked=!0;break}},radioChangeOnlyChild:function(e){for(var t=0;t<this.itemsOnlyChild.length;t++)if(this.itemsOnlyChild[t].value===e.target.value){this.current=t,this.onlyChild=e.target.value;break}},radioChangeHouse:function(e){for(var t=0;t<this.itemsHouse.length;t++)if(this.itemsHouse[t].value===e.target.value){this.current=t,this.house=e.target.value;break}},radioChangeCar:function(e){for(var t=0;t<this.itemsCar.length;t++)if(this.itemsCar[t].value===e.target.value){this.current=t,this.car=e.target.value;break}},radioChangeEdu:function(e){for(var t=0;t<this.itemsEdu.length;t++)if(this.itemsEdu[t].value===e.target.value){this.current=t,this.edu=e.target.value;break}},radioChangeMarriage:function(e){for(var t=0;t<this.itemsMarriage.length;t++)if(this.itemsMarriage[t].value===e.target.value){this.current=t,this.marriage=e.target.value;break}},radioChangePhotoPublic:function(e){for(var t=0;t<this.itemsPhotoPublic.length;t++)if(this.itemsPhotoPublic[t].value===e.target.value){this.current=t,this.photoPublic=e.target.value;break}},bindDateChange:function(e){this.date=e.target.value},getDate:function(e){var t=new Date,i=t.getFullYear(),n=t.getMonth()+1;return"start"===e?i-=100:"end"===e&&(i=i),n=n>9?n:"0"+n,"".concat(i,"-").concat(n)},upimgfunc:function(){var e=this;wx.showActionSheet({itemList:["直接拍照","相册选取","微信会话选取"],success:function(t){console.log(t.tapIndex),0==t.tapIndex&&(console.log("直接拍照"),e.uploadImgcamera()),1==t.tapIndex&&(console.log("相册选取"),e.uploadImgalbum()),2==t.tapIndex&&(console.log("微信会话选取"),e.uploadImgmsg())},fail:function(e){console.log(e.errMsg)}})},uploadImgalbum:function(){var t=this;this.curindex=0,e.chooseImage({count:3,sizeType:["compressed"],sourceType:["album","camera"],success:function(i){if(t.paths=i.tempFilePaths,i.tempFiles.length>0){e.showLoading({title:"上传中..."});var n=i.tempFiles[0].path,o=n.split("."),a=Date.now()+Math.ceil(100*Math.random())+"."+o.slice(-1),s=o.slice(-1);console.log("上传图片单张还是多张~~~~~~"),console.log(i.tempFilePaths),i.tempFilePaths.length>1?t.batchCompress(i.tempFilePaths,a,s):t.compress(i.tempFilePaths,a,s)}}})},cloudUpload:function(t,i){var a=this;n.uploadFile({filePath:t,cloudPath:i,fileType:"image",success:function(t){return r(o.default.mark((function i(){var s,r,c;return o.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return console.log(t),s=t.fileID,r={media_url:t.fileID,media_type:2},i.next=5,a.$api.showLoading();case 5:return i.next=7,a.$api.postData(a.$api.webapi.mediaCheck,r);case 7:return c=i.sent,i.next=10,a.$api.hideLoading();case 10:console.log(c),a.imglist=a.imglist.concat(t.fileID),console.log("this_imglist is ="),console.log(a.imglist),n.callFunction({name:"addImage",data:{imageUrl:s,createTime:Date.now()},success:function(t){console.log("数据插入成功"),console.log(t),e.showToast({title:"上传成功",icon:"none"})},fail:function(e){console.log(e)},complete:function(){}});case 15:case"end":return i.stop()}}),i)})))()},fail:function(e){console.log(e)},complete:function(){e.hideLoading()}})},cloudUploads:function(t){console.log(t);var i=this,o=0;function a(){var t=i.filelist[o],s=t.split("."),r=Date.now()+Math.ceil(100*Math.random())+"."+s.slice(-1);s.slice(-1);n.uploadFile({filePath:t,cloudPath:r,fileType:"image",success:function(t){console.log(t);var s=t.fileID;i.imglist=i.imglist.concat(t.fileID),console.log("this_imglist is ="),console.log(i.imglist),n.callFunction({name:"addImage",data:{imageUrl:s,createTime:Date.now()},success:function(t){console.log("数据插入成功"),console.log(t),o+1<i.filelist.length?(o++,a()):e.showToast({title:"上传成功",icon:"none"})},fail:function(e){console.log(e)},complete:function(){}})},fail:function(e){console.log(e)},complete:function(){e.hideLoading()}})}this.filelist=[],this.filelist=t,a()},compress:function(t,i,n){var o=this;e.showLoading({title:"压缩中",mask:!0}),this.$refs.helangCompress.compress({src:t[0],maxSize:750,fileType:n,quality:.95,minSize:640}).then((function(t){e.hideLoading(),e.showToast({title:"压缩成功",icon:"success"}),o.compressPaths=o.compressPaths.concat([t]),o.cloudUpload(t,i)})).catch((function(t){e.hideLoading(),e.showToast({title:"压缩失败",icon:"none"})}))},batchCompress:function(t,i,n){var o=this;this.$refs.helangCompress.batchCompress({batchSrc:t,maxSize:750,fileType:n,quality:.95,minSize:640,progress:function(t){e.showLoading({title:"进度:".concat(t.done+t.fail,"/").concat(t.count)}),console.log(t)}}).then((function(t){e.hideLoading(),e.showToast({title:"压缩完成",icon:"success"}),console.log("批量压缩返回图片 ================= "),console.log(t),o.compressPaths=o.compressPaths.concat(t),o.cloudUploads(t)})).catch((function(t){e.hideLoading(),e.showToast({title:"压缩失败",icon:"none"})}))},preview:function(t){var i=t.currentTarget.dataset.index;e.previewImage({current:this.imglist[i],urls:this.imglist})},submitSuccess:function(){setTimeout((function(){e.reLaunch({url:"/pages/my/my"})}),1500)},submitEvent:function(){var t=r(o.default.mark((function t(){var i,n,a,s,r,c;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=this,""==this.sex&&e.showToast({title:"请必须填写性别",icon:"none"}),n=this.date.split("-"),a=n[0],s=n[1],1!=this.isEdit){t.next=22;break}if(r={id:this.id,number:this.number,gender:this.sex?this.sex:"",birthYear:a,birthMonth:s,zodiacConstellation:this.sxxz,height:this.shengao,bodyWeight:this.tizhong,education:this.edu,job:this.job,income:this.income,house:this.house,houseTxt:this.houseTxt,car:this.car,carTxt:this.carTxt,hometown:this.hometown,workArea:this.workArea,parentsInfo:this.parentsInfo,onlyChild:this.onlyChild,family:this.family,marriage:this.marriage,marriageTxt:this.marriageTxt,introduction:this.introduction,requirement:this.requirement,imageList:JSON.stringify(this.imglist)},console.log(r),1!=this.infoLock){t.next=12;break}e.showToast({title:"该用户已锁定",icon:"none",duration:1500}),t.next=20;break;case 12:return t.next=14,this.$api.showLoading();case 14:return t.next=16,this.$api.postData(this.$api.webapi.memberUpdate,r);case 16:return c=t.sent,t.next=19,this.$api.hideLoading();case 19:this.$api.reshook(c,this.$mp.page.route)&&(console.log(c),e.showToast({title:"提交成功,后台审核通过后自动发布此信息",icon:"none"}),i.submitSuccess());case 20:t.next=36;break;case 22:if(r={gender:this.sex?this.sex:"",birthYear:a,birthMonth:s,zodiacConstellation:this.sxxz,height:this.shengao,bodyWeight:this.tizhong,education:this.edu,job:this.job,income:this.income,house:this.house,houseTxt:this.houseTxt,car:this.car,carTxt:this.carTxt,hometown:this.hometown,workArea:this.workArea,parentsInfo:this.parentsInfo,onlyChild:this.onlyChild,family:this.family,marriage:this.marriage,marriageTxt:this.marriageTxt,introduction:this.introduction,requirement:this.requirement,imageList:JSON.stringify(this.imglist)},console.log(r),1!=this.infoLock){t.next=28;break}e.showToast({title:"该用户已锁定",icon:"none",duration:1500}),t.next=36;break;case 28:return t.next=30,this.$api.showLoading();case 30:return t.next=32,this.$api.postData(this.$api.webapi.memberCreate,r);case 32:return c=t.sent,t.next=35,this.$api.hideLoading();case 35:this.$api.reshook(c,this.$mp.page.route)&&(console.log(c),e.showToast({title:"提交成功",icon:"none"}),i.submitSuccess());case 36:case"end":return t.stop()}}),t,this)})));function i(){return t.apply(this,arguments)}return i}()}};t.default=l}).call(this,i("543d")["default"],i("a9ff")["default"])},dd61:function(e,t,i){}},[["b2e4","common/runtime","common/vendor"]]]);