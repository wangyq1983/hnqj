(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{6211:function(e,n,t){},"811a":function(e,n,t){"use strict";t.r(n);var a=t("ed37"),o=t.n(a);for(var r in a)"default"!==r&&function(e){t.d(n,e,(function(){return a[e]}))}(r);n["default"]=o.a},"81b4":function(e,n,t){"use strict";var a=t("6211"),o=t.n(a);o.a},"9fde":function(e,n,t){"use strict";(function(e){t("b752");a(t("66fd"));var n=a(t("a706"));function a(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},a706:function(e,n,t){"use strict";t.r(n);var a=t("bdd1"),o=t("811a");for(var r in o)"default"!==r&&function(e){t.d(n,e,(function(){return o[e]}))}(r);t("81b4");var i,s=t("f0c5"),u=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],i);n["default"]=u.exports},bdd1:function(e,n,t){"use strict";var a;t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return a}));var o=function(){var e=this,n=e.$createElement;e._self._c},r=[]},ed37:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=o(t("a34a"));function o(e){return e&&e.__esModule?e:{default:e}}function r(e,n,t,a,o,r,i){try{var s=e[r](i),u=s.value}catch(c){return void t(c)}s.done?n(u):Promise.resolve(u).then(a,o)}function i(e){return function(){var n=this,t=arguments;return new Promise((function(a,o){var i=e.apply(n,t);function s(e){r(i,a,o,s,u,"next",e)}function u(e){r(i,a,o,s,u,"throw",e)}s(void 0)}))}}var s={data:function(){return{origin:"",SessionKey:"",OpenId:"",nickName:null,avatarUrl:null,userinfo:{},code:"",isPhone:!0,noagree:!0,isCanUse:e.getStorageSync("isCanUse")||!0}},onLoad:function(n){var t=this;e.getSystemInfo({success:function(e){console.log("设备是"),console.log(e),-1!=e.model.indexOf("iPad")?t.isPhone=!1:t.isPhone=!0}}),this.origin="/"+decodeURIComponent(n.url),console.log(this.origin)},methods:{agreeEvent:function(){this.noagree=!1},wxGetUserInfo:function(){var n="weixin",t=this;e.getUserInfo({provider:n,success:function(n){console.log(n);n.userInfo.nickName,n.userInfo.avatarUrl;try{e.setStorageSync("isCanUse",!1),t.updateUserInfo()}catch(a){}},fail:function(e){}})},login:function(){var n=this;e.showLoading({title:"登录中..."});var t="weixin";e.login({provider:t,success:function(){var o=i(a.default.mark((function o(r){var s;return a.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:console.log(r),s={code:r.code},e.getUserInfo({provider:t,success:function(){var e=i(a.default.mark((function e(o){var r,i,u;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o.userInfo.nickName,o.userInfo.avatarUrl,n.userinfo=o.userInfo,r={rawData:o.rawData,signature:o.signature,encryptedData:o.encryptedData,iv:o.iv},Object.assign(n.userinfo,s,r),i=n.userinfo,console.log(i),e.next=9,n.$api.showLoading();case 9:return e.next=11,n.$api.postData(n.$api.webapi.uniLogin,i);case 11:return u=e.sent,e.next=14,n.$api.hideLoading();case 14:n.$api.reshook(u,"/pages/login/login")&&n.loginSuccess(u,t);case 15:case"end":return e.stop()}}),e)})));function o(n){return e.apply(this,arguments)}return o}()});case 3:case"end":return o.stop()}}),o)})));function r(e){return o.apply(this,arguments)}return r}()})},loginSuccess:function(n,t){var o=this;return i(a.default.mark((function t(){var r,s,u,c;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(console.log(o.origin),console.log("loginsuccess"),console.log(n.data),r=["avatarUrl","nickName","isLogin","userId","userType"],s=[n.data.weiChatAuthUser.avatarUrl,n.data.name,!0,n.data.userId,n.data.type],u=o,c=0;c<r.length;c++)e.setStorage({key:r[c],data:s[c]});e.setStorage({key:"token",data:n.data.token,success:function(){var n=i(a.default.mark((function n(){var t;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("set token is = "),console.log(e.getStorageSync("token")),n.next=4,u.$api.getUserinfo();case 4:t=n.sent,t?(console.log("来源网址"),console.log(u.origin),e.reLaunch({url:"/undefined"!==u.origin?u.origin:"/pages/rwlist/rwlist"})):e.showToast({title:"获取用户信息失败",icon:"none",duration:2e3});case 6:case"end":return n.stop()}}),n)})));function t(){return n.apply(this,arguments)}return t}()});case 8:case"end":return t.stop()}}),t)})))()},updateUserInfo:function(){var n=this;e.request({url:"url",data:{appKey:this.$store.state.appKey,customerId:n.customerId,nickName:n.nickName,headUrl:n.avatarUrl},method:"POST",header:{"content-type":"application/json"},success:function(n){"success"==n.data.state&&e.reLaunch({url:"/pages/index/index"})}})}}};n.default=s}).call(this,t("543d")["default"])}},[["9fde","common/runtime","common/vendor"]]]);